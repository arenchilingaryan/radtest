var lag=12,grow=20,shrink=20,windowHeight=window.innerHeight,scrollAmount=0,stretchAmount=0,stretchDirection=0,mouseDown=!1,scrollMove=0,transitionProgress=0,currentPrev=null,currentNext=null,images=document.getElementsByClassName("image"),stripe=document.getElementById("stripe");for(window.addEventListener("resize",function(){windowHeight=window.innerHeight}),window.addEventListener("mousedown",function(){mouseDown=!0}),window.addEventListener("mouseup",function(){mouseDown=!1}),i=0,lim=images.length;i<lim;i++)images[i].addEventListener("click",function(){scrollToImage(this)});function scrollToImage(e){var t=e.getBoundingClientRect();scrollMove=windowHeight/2-(t.top+t.height/2)}function goToPrev(){currentPrev&&scrollToImage(currentPrev)}function goToNext(){currentNext&&scrollToImage(currentNext)}function animate(){if(scrollAmount+=(window.pageYOffset-scrollAmount)/lag,stretchDirection+=(window.pageYOffset-scrollAmount)*grow,stretchDirection=(stretchDirection/=shrink)<0?Math.max(-.3*windowHeight,stretchDirection):Math.min(.3*windowHeight,stretchDirection),stretchAmount=Math.abs(stretchDirection),0!==Math.floor(Math.abs(scrollMove))){var e=Math.floor(scrollMove/lag);window.scrollTo(0,window.pageYOffset-e),scrollMove-=e}for(mouseDown?(transitionProgress+=.01,transitionProgress*=1+transitionProgress/grow):transitionProgress*=1-transitionProgress/shrink,transitionProgress=Math.min(transitionProgress,1),i=0,lim=images.length;i<lim;i++){var t=images[i],n=t.getBoundingClientRect(),o=(windowHeight-n.top)/(windowHeight+n.height);o=Math.max(0,Math.min(1,o)),n.top>0&&n.bottom<windowHeight?(addClass(t,"is-center"),currentPrev=images[i-1]||t,currentNext=images[i+1]||t):removeClass(t,"is-center");var r=t.children[0],s=t.children[1],a=s.children[0],c=t.children[2];r.style.height=100*o+"%",r.style.transform="translateY("+(stretchDirection+(.5-o)*windowHeight)+"px)",s.style.height=stretchAmount+2+"px",s.style.transform="translateY("+(stretchDirection+(.5-o)*windowHeight)+"px)",a.style.backgroundPosition="0 "+100*o+"%",c.style.height=100*(1-o)+"%",c.style.transform="translateY("+(stretchDirection+(.5-o)*windowHeight)+"px)"}requestAnimationFrame(animate)}function addClass(e,t){e.classList?e.classList.add(t):hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"")}document.getElementById("prev").addEventListener("click",goToPrev),document.getElementById("next").addEventListener("click",goToNext),requestAnimationFrame(animate);